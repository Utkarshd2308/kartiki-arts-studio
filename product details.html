<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details | Kartiki Resin Arts</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body { font-family: system-ui, sans-serif; background: #f5f7fa; color: #333; margin: 0; padding: 0; }
        .container { max-width: 800px; margin: 20px auto; background: #fff; border-radius: 20px; overflow: hidden; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .back-btn { padding: 15px; display: inline-block; color: #b02e72; text-decoration: none; font-weight: bold; }
        
        .main-image { width: 100%; aspect-ratio: 1/1; object-fit: contain; background: #fff; }
        .details-content { padding: 25px; }
        .category { color: #b02e72; font-weight: bold; text-transform: uppercase; font-size: 0.8rem; }
        .title { font-size: 1.8rem; margin: 10px 0; color: #444; }
        .price { font-size: 1.5rem; color: #e74c3c; font-weight: 800; margin-bottom: 15px; }
        .description { line-height: 1.6; color: #666; white-space: pre-wrap; margin-bottom: 25px; }
        
        .image-gallery { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 30px; }
        .image-gallery img { width: 100%; height: 80px; object-fit: cover; border-radius: 10px; cursor: pointer; border: 2px solid transparent; transition: 0.3s; }
        .image-gallery img:hover { border-color: #b02e72; transform: scale(1.05); }

        /* Place Order Button Style */
        .order-btn { 
            width: 100%; 
            background: #b02e72; 
            color: white; 
            border: none; 
            padding: 15px; 
            border-radius: 12px; 
            font-size: 1.1rem; 
            font-weight: bold; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 10px; 
            text-decoration: none;
            transition: 0.3s;
        }
        .order-btn:hover { background: #8e255c; }
        
        .loading { text-align: center; padding: 50px; font-weight: bold; color: #b02e72; }
    </style>
</head>
<body>

<div class="container" id="productContainer">
    <a href="index.html" class="back-btn"><i class="fas fa-arrow-left"></i> Back to Shop</a>
    
    <div id="loading" class="loading">Loading Product Details...</div>
    
    <div id="content" style="display:none;">
        <img id="displayImg" class="main-image" src="" alt="Product Image">
        
        <div class="details-content">
            <div id="pCategory" class="category"></div>
            <h1 id="pName" class="title"></h1>
            <div id="pPrice" class="price"></div>
            <div id="pDescription" class="description"></div>
            
            <h3>More Images</h3>
            <div id="pGallery" class="image-gallery"></div>
            
            <button id="placeOrderBtn" class="order-btn">
                <i class="fas fa-shopping-bag"></i> Place Order
            </button>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBHDap_BTykTSNcH0l1m1VdLB_MK6LgZCo",
        authDomain: "artikiart.firebaseapp.com",
        projectId: "artikiart",
        storageBucket: "artikiart.firebasestorage.app",
        messagingSenderId: "191730558371",
        appId: "1:191730558371:web:f3a64f2a04a78fa5a0a616"
    };
    firebase.initializeApp(firebaseConfig);

    const urlParams = new URLSearchParams(window.location.search);
    const productId = urlParams.get('id');

    if (productId) {
        firebase.database().ref('products/' + productId).once('value').then((snapshot) => {
            const p = snapshot.val();
            if (p) {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('content').style.display = 'block';

                const mainImg = (p.images && p.images.length > 0) ? p.images[0] : 'https://via.placeholder.com/500?text=No+Image';
                document.getElementById('displayImg').src = mainImg;
                document.getElementById('pName').innerText = p.name;
                document.getElementById('pCategory').innerText = p.category;
                document.getElementById('pPrice').innerText = '₹' + p.price;
                document.getElementById('pDescription').innerText = p.description || "Beautiful handmade resin art.";

                // गॅलरी लोड करणे
                if (p.images && p.images.length > 0) {
                    const gallery = document.getElementById('pGallery');
                    gallery.innerHTML = ""; // Clear existing
                    p.images.forEach(imgUrl => {
                        const img = document.createElement('img');
                        img.src = imgUrl;
                        img.onclick = () => document.getElementById('displayImg').src = imgUrl;
                        gallery.appendChild(img);
                    });
                } else {
                    document.querySelector('h3').style.display = 'none';
                }

                // "Place Order" बटणची लिंक सेट करणे
                document.getElementById('placeOrderBtn').onclick = function() {
                    const queryParams = new URLSearchParams({
                        id: productId,
                        name: p.name,
                        price: p.price
                    }).toString();
                    window.location.href = `order form.html?${queryParams}`;
                };

            } else {
                document.getElementById('loading').innerText = "Product not found!";
            }
        }).catch(error => {
            console.error(error);
            document.getElementById('loading').innerText = "Error loading product.";
        });
    } else {
        window.location.href = "index.html";
    }
</script>

</body>
</html>